<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width" />
<title>codモバイル武器ランダム</title>
<style>
  body {
      background-image: url("okura_bg2.jpg"); /* 画像のパス */
      background-size: contain; 
      background-position: center; /* 中央配置 */
      background-repeat: repeat; /* 繰り返しなし */
      font-weight: bold;
  }
  .s_text1 {
            display: inline-block; /* 回転が適用されるようにする */
            transform: rotate(-15deg); /* 15度傾ける */
            font-size: 12px;
            font-weight: bold;
            color: red;
        }
  .s_text2 {
      display: inline-block; /* 回転が適用されるようにする */
      transform: rotate(10deg); /* 15度傾ける */
      font-size: 12px;
      font-weight: bold;
      color: blue;
  }
  .s_text3 {
      display: inline-block; /* 回転が適用されるようにする */
      transform: rotate(5deg); /* 15度傾ける */
      font-size: 12px;
      font-weight: bold;
      color: green;
  }
  .s_text4 {
      display: inline-block; /* 回転が適用されるようにする */
      transform: rotate(-10deg); /* 15度傾ける */
      font-size: 12px;
      font-weight: bold;
      color: purple;
  }

  .top-right-text {
      position: fixed; /* 画面上の固定位置 */
      top: 10px;  /* 上から10px */
      right: 10px; /* 右から10px */
      font-size: 16px; /* 文字サイズ */
      color: gray; /* 文字色 */
      padding: 5px 10px; /* 余白 */
      border-radius: 5px; /* 角丸 */
  }
  /* ボタンのデザイン */
  .make_weapon_button {
            font-size: 20px;  /* 文字サイズ */
            padding: 10px 20px;  /* ボタン内の余白 */
            background-color: #007BFF;  /* 背景色（青色） */
            color: white;  /* 文字色 */
            border: none;  /* 枠線なし */
            border-radius: 10px;  /* 角丸 */
            cursor: pointer;  /* カーソルをポインターに */
            transition: 0.3s;  /* アニメーション */
        }

        /* ホバー時のデザイン */
        .custom-button:hover {
            background-color: #0056b3;  /* ホバー時の背景色 */
        }

        /* クリック時のデザイン */
        .custom-button:active {
            background-color: #004494;
        }
  /* ボタンのデザイン */
  .copy_button {
            font-size: 20px;  /* 文字サイズ */
            padding: 10px 20px;  /* ボタン内の余白 */
            background-color: #007BFF;  /* 背景色（青色） */
            color: white;  /* 文字色 */
            border: none;  /* 枠線なし */
            border-radius: 10px;  /* 角丸 */
            cursor: pointer;  /* カーソルをポインターに */
            transition: 0.3s;  /* アニメーション */
        }

        /* ホバー時のデザイン */
        .custom-button:hover {
            background-color: #0056b3;  /* ホバー時の背景色 */
        }

        /* クリック時のデザイン */
        .custom-button:active {
            background-color: #004494;
        }
</style>
</head>
<body>
  <div class="top-right-text">Version : 1.2.1</div>
<BR>
<p class="s_text1">君だけの最強武器を見つけよう！</p>
<p class="s_text2">無料！！</p>
<p class="s_text3">最高！</p>
<p class="s_text4">怪しくないよ！</p>
<div id="copyTarget"> </div>
<button class="make_weapon_button" onclick="make_weapon()">作成</button>
<button class="copy_button" onclick="copyToClipboard()">コピー</button>
<BR>
<fieldset>
<legend>ランダムで現れる武器の種類</legend>
<input type="checkbox" name="W" value="0" checked>AR
<BR>
<input type="checkbox" name="W" value="1" checked>SR
<BR>
<input type="checkbox" name="W" value="2" checked>SMG
<BR>
<input type="checkbox" name="W" value="3" checked>LMG
<BR>
<input type="checkbox" name="W" value="4" checked>SG
<BR>
<input type="checkbox" name="W" value="5" checked>MR
</fieldset>
<BR>
  

<fieldset>
  <legend>セットするガンスミスの数</legend>
<form>
  <label><input type="radio" name="number" value="1"> 1</label>
  <label><input type="radio" name="number" value="2"> 2</label>
  <label><input type="radio" name="number" value="3"> 3</label>
  <label><input type="radio" name="number" value="4"> 4</label>
  <label><input type="radio" name="number" value="5" checked> 5</label>
  <BR>
  ランダム(1~5個) : <input type="checkbox" id="rand_num_gunsmith">
</form>
</fieldset>

  <fieldset>
    <legend>武器固定</legend>
武器固定モード : <input type="checkbox" id="fixed_weapon">
<BR>
武器名 : <select id="weapon-select">
        <!-- JavaScriptで武器を追加 -->
    </select>
</fieldset>
  <fieldset>
    <legend>出現するガンスミス</legend>
  <form>
    <label><input type="checkbox" name="rep_gunsmith" value="1" checked> マズル</label>
    <label><input type="checkbox" name="rep_gunsmith" value="2" checked> バレル</label>
    <label><input type="checkbox" name="rep_gunsmith" value="3" checked> サイト</label>
    <label><input type="checkbox" name="rep_gunsmith" value="4" checked> ストック</label>
    <label><input type="checkbox" name="rep_gunsmith" value="5" checked> PERK</label>
    <label><input type="checkbox" name="rep_gunsmith" value="6" checked> レーザー</label>
    <label><input type="checkbox" name="rep_gunsmith" value="7" checked> アンダーバレル</label>
    <label><input type="checkbox" name="rep_gunsmith" value="8" checked> 弾薬</label>
    <label><input type="checkbox" name="rep_gunsmith" value="9" checked> リアグリップ</label>
  </form>
</fieldset>
  
  <fieldset>
    <legend>武器選択モード</legend>
  <form>
    <label><input type="radio" name="prob_mode_weapon" value="0" checked>色んな武器を使いたい</label>
    <BR>
    <label><input type="radio" name="prob_mode_weapon" value="1">色んなクラス(ARやSRなど)を使いたい</label>
  </form>
</fieldset>
  <fieldset>
    <legend>ガンスミス選択モード</legend>
  <form>
    <label><input type="radio" name="prob_mode_gunsmith" value="0" checked>色んなアタッチメントを使いたい</label>
    <BR>
    <label><input type="radio" name="prob_mode_gunsmith" value="1">バレルやサイトなどを等しく使いたい</label>
  </form>
</fieldset>
<h1>説明</h1>
1. 作成ボタンを押すことでランダムにガンスミスを設定してくれます.
<BR>
2. 作成した武器はコピーのボタンを押すことで端末が自動でコピーします.
<BR>
3. CODmの画面を開き,テキトーな武器を選んでガンスミスの画面を開きます.
<BR>
4. 右下にある"NO."と書いてあるボタンを押し,コピーした内容を貼り付け(ペースト)します.
<BR>
5. 装備を押すと完成です.
<BR>
<BR>

武器固定に正しく武器名を入力し,武器固定モードを押すとその武器のガンスミスを作成します.
<BR>
<BR>

武器選択モードでは武器選択の確率を変えることができます.例えば,マークスマンは5個でARは32個存在します.全ての武器が同じ確率だとマークスマンはなかなか選ばれません.反対にクラスが同じ確率だと同じマークスマンライフルが選ばれやすくなります.
<BR>
<BR>
ガンスミス選択モードも武器選択モードと構造は同じです.
<BR>
<BR>

当サイトで認識している現時点の最新武器はM1 Garandです.
<BR>
<h1>注意</h1>
CODm内で"このコードにマッチするものが見つかりません"と表示された場合は当サイトのプログラムのミスです.
再度作成してください.
<BR>
<BR>

競合不可能な武器は選ばないように設定してあります.(デュアルやインテグラルサプレッサー等に対してプログラムを書くのが非常にめんどくさいから.)
<BR>
<BR>

ルームでの縛りプレイ等がメインで作成したプログラムとなります.
<BR>
<BR>

ランクマッチで使用する場合は自己責任でお願い致します.(当たり前)
<BR>
<BR>

<h1>その他</h1>
当サイトを自由に使用していただいて構いません.
<BR>
<BR>

  しんじゅ(@sj_select)に提案や一部コード作成をして頂きました.
  <BR>
    おくら(@hateyoubut68)に背景のデザインを頂きました.
  <BR>
意見,アドバイス,提案,質問はXアカウントのほつすすねる(@tanakakuuunnn)まで気軽に連絡して頂けると幸いです.
<BR>
<BR>

全員武器ガンスミスランダム縛りのルームをやってみたい.
<script>

const weapons=[["Type 25","M16","AK117","AK-47","ASM10","M4","BK57","LK24","ICR-1","Man-O-War",
                "KN-44","HBRa3","HVK-30","DR-H","Peacekeeper MK2","FR .556","AS VAL","CR-56 AMAX",
                "M13","Swordfish","Kilo 141","Oden","Krig 6","EM2","Maddox","FFAR 1","Grau 5.56",
                "Groza","Type 19","BP50","LAG 53","XM4"],
              ["XPR-50","Arctic .50","M21 EBR","DL Q33","Locus","NA-45","Outlaw","Rytec AMR","SVD","Koshka","ZRG 20mm","HDR","LW3-Tundra"],
              ["RUS-79U","Chicom","PDW-57","Razorback","MSMC","HG 40","Pharo","GKS","Cordite","QQ9","Fennec","AGR 556","QXR","PP19 Bizon",
              "MX9","CBR4","PPSh-41","MAC-10","KSP 45","Switchblade X9","LAPA","OTs 9","Striker 45","CX-9","TEC-9","ISO","USS 9"],
              ["S36","UL736","RPD","M4LMG", "Chopper", "Holger 26","Hades","PKM", "Dingo","Bruen MK9","MG42","RAAL MG"],
              ["HS2126","BY15","HS0405","Striker","KRM-262","Echo","R9-0","JAK-12","Argus","VLK Rogue"],
              ["Kilo Bolt-Action","SKS","SP-R 208","MK2","Type 63","M1 Garand"]];

//AK117のバレルYKMを除いていたりする。
const weapon_parts_char=[[[6,3,18,3,8,3,5,3,5],[6,2,18,4,9,3,5,2,3],[7,3,18,4,8,3,6,2,3],[6,4,18,5,8,3,5,3,3],[6,4,18,4,8,3,5,2,3],
                          [6,4,18,4,8,3,6,2,3],[7,3,18,3,8,3,6,3,3],[6,2,18,4,8,3,5,2,3],[7,2,18,4,8,3,5,3,3],[7,3,18,3,8,3,5,2,3],
                          [7,3,18,4,8,3,5,2,3],[7,3,18,5,8,3,5,2,3],[6,2,18,3,8,3,5,3,3],[7,3,18,4,8,3,5,4,3],[6,4,18,4,8,3,5,2,3],
                          [6,3,18,3,8,3,6,2,3],[0,3,18,4,7,3,6,3,3],[6,3,18,6,8,3,6,2,3],[6,2,18,4,8,3,5,4,3],[6,3,18,3,8,3,6,3,3],
                          [6,2,18,4,8,3,6,3,3],[7,3,18,3,8,3,5,4,3],[5,6,18,6,8,3,6,6,3],[6,3,18,3,8,3,6,3,3],[0,5,18,4,8,3,0,6,4],
                          [6,6,18,6,8,3,6,6,6],[6,5,18,3,8,3,5,2,3],[6,6,14,6,7,3,6,6,6],[7,4,20,4,8,3,8,3,4],[5,3,20,4,8,3,0,3,9],
                          [4,3,17,4,8,3,4,2,3],[6,6,18,6,8,2,6,6,6]],                                             //XM4
                    //スナイパー
                    [[6,3,7,3,8,1,6,3,0],[6,4,7,3,7,0,1,3,3],[6,3,7,4,8,1,6,2,0],[6,3,7,4,7,1,1,3,0],[6,3,7,3,7,1,0,3,3],
                     [5,3,7,3,6,1,8,3,0],[6,3,7,5,9,1,1,2,3],[6,3,7,3,7,1,1,2,3],[6,2,7,3,7,1,1,2,0],[6,2,7,3,7,2,0,3,3],
                     [6,3,7,3,7,1,1,3,4],[6,3,7,4,8,1,1,2,0],[6,6,7,6,8,1,4,6,6]],  //たんどら
                    //SMG
                    [[6,3,15,4,8,4,5,3,3],[6,3,15,3,8,3,6,3,2],[6,2,15,3,8,3,4,0,3],[6,2,14,3,9,3,4,3,1],[6,3,15,4,8,3,5,3,3],
                     [6,2,15,5,8,3,5,3,3],[6,3,15,3,8,3,7,3,3],[6,2,15,3,8,3,5,3,3],[6,2,15,3,8,3,4,2,3],[6,3,15,4,7,3,5,3,3],
                    //fennec
                     [6,3,15,4,8,5,5,3,3],[6,3,15,3,8,3,5,3,3],[6,3,15,4,9,3,5,2,3],[6,3,15,4,8,3,0,2,3],[6,2,15,4,7,3,5,2,3],
                     [6,2,15,3,8,3,3,0,3],[6,3,15,3,8,3,5,2,3],[6,5,15,4,7,3,6,4,3],[6,4,15,4,7,3,6,2,3],[6,3,15,3,9,3,5,2,3],
                     [6,5,15,6,7,3,6,6,3],[6,6,15,6,7,3,6,5,3],[6,3,15,3,8,3,5,2,3],[6,5,15,3,8,3,5,3,3],[7,6,8,6,5,3,6,6,6],
                     [6,4,15,4,8,3,5,2,3],[6,4,15,4,8,3,5,3,3]], //USS
                    //LMG
                    [[6,3,18,3,7,3,6,3,2],[6,3,18,3,7,3,6,3,2],[5,3,18,4,8,3,6,2,3],[6,2,18,4,7,3,4,2,3],[6,3,18,3,7,5,6,2,3],
                     [6,2,18,4,7,3,6,2,3],[6,3,18,4,7,3,1,1,4],[5,3,18,4,8,3,6,2,3],[7,4,18,4,8,3,6,4,3],[6,3,18,5,8,3,6,2,3],
                     [7,4,20,5,8,0,6,4,10],[6,3,18,4,6,1,4,2,3]], //RAAL
                  //SG
                    [[6,3,15,3,6,3,2,3,3],[7,3,15,4,6,3,6,2,3],[6,2,15,2,6,3,2,2,3],[6,4,15,3,6,3,2,3,3],[7,3,15,5,6,3,4,2,3],
                     [6,3,15,4,6,3,2,3,3],[6,2,15,2,6,3,3,3,3],[7,3,15,3,6,3,5,4,3],[4,3,12,5,6,3,3,3,4],[7,3,15,4,6,3,3,4,3]], //VLK Rogue
                //MR
                    [[6,3,17,3,8,1,1,3,3],[5,3,7,3,8,1,6,2,3],[6,3,17,4,7,1,6,3,2],[6,3,17,4,7,1,0,1,3],[6,6,7,6,7,3,6,6,6]
                  ,[6,4,11,5,6,0,5,4,0]]]; //M1 Garand

                    
//武器の数、追加ごとに更新最新は[XM4,たんどら,USS,Raal,argus,type63]

function sumArray(x){
  total=0;
  for(var i=0;i<x.length;i++){
    total+=x[i];
  }
  return total
}

function findIntervalIndex(x,interval){
  for(var i=0;i<interval.length;i++){
    if(interval[i]>=x){
      return i
    }
  }
}
function make_interval(array){
  total_num=sumArray(array);
  interval = Array(array.length).fill(0);

  distri=0;
  for(var i=0;i<array.length;i++){
    distri+=array[i]/total_num;
    interval[i]=distri;
  }
  return interval

}
function choice(x,array){
  interval=make_interval(array);
  return findIntervalIndex(x,interval);
}

function findWeaponIndex(weaponName) {
  for (let i = 0; i < weapons.length; i++) {
    let weaponIndex = weapons[i].indexOf(weaponName); // 各カテゴリー内で検索
    if (weaponIndex !== -1) {
      return [i,weaponIndex];
    }
  }
  return null; // 見つからなかった場合
}

function findWeaponIndex(weaponName) {
  for (let i = 0; i < weapons.length; i++) {
    let weaponIndex = weapons[i].indexOf(weaponName); // 各カテゴリー内で検索
    if (weaponIndex !== -1) {
      return [i,weaponIndex];
    }
  }
  return null; // 見つからなかった場合
}

// ドロップダウン要素を取得
const select_w = document.getElementById("weapon-select");

// 武器リストを追加
for(var i=0;i<weapons.length;i++){
  for(var j=0;j<weapons[i].length;j++){

    const option = document.createElement("option");
    option.value = weapons[i][j];
    option.textContent = weapons[i][j];
    select_w.appendChild(option);
  }
}

function make_weapon_structure(){
      const rngm = document.getElementById("rand_num_gunsmith");
      rand_num_gunsmith_mode = rngm.checked; // セットするガンスミスの数
      if(rand_num_gunsmith_mode==false){
        const selected_sgn = document.querySelector('input[name="number"]:checked');
        set_gunsmith_num = selected_sgn.value; // セットするガンスミスの数
      }else{
        set_gunsmith_num=Math.floor(Math.random()*5)+1;
      }
      const selected_pmw = document.querySelector('input[name="prob_mode_weapon"]:checked');
      
      prob_mode_weapon = selected_pmw.value; // 確率のモード
      const selected_pmg = document.querySelector('input[name="prob_mode_gunsmith"]:checked');
      prob_mode_gunsmith = selected_pmg.value; // ガンスミスの確率のモード
      const checkbox = document.getElementById("fixed_weapon");
      fixed_weapon_mode=checkbox.checked;
      
      
      if(fixed_weapon_mode==false){
        //チェックボックスで色々する。
        var WT=document.getElementsByName("W");
        //pmwが0ならそれぞれの武器の数を計算、pmwが1ならチェックのない武器を0個に設定それ以外を1
        weapons_each_num=Array(weapons.length).fill(1);
        for(var i=0;i<weapons.length;i++){ 
          if(WT[i].checked==true){
            
            if(prob_mode_weapon==0){
              weapons_each_num[i]=weapons[i].length;
            }else if(prob_mode_weapon==1){
              continue
            }   
          }else{
            weapons_each_num[i]=0;
          }     
        }        
        //武器の種類を決める(AR、SR、SMGなど)
        weapon_type=choice(Math.random(),weapons_each_num);
        //上で決めたカテゴリーのなかで武器を決める(AK117など)
        weapon_name=Math.floor(Math.random()*weapons[weapon_type].length);

      }else{
        const deicide_weapon_name = select_w.value;
        const result = findWeaponIndex(deicide_weapon_name);

        if (result) {
          weapon_type=result[0];
          weapon_name=result[1];
        } else {
          alert("武器名が正しくないか,当サイトの現バージョンでは存在しません.");
          return "error"
        }
      }


        //まずるなどの数値とその中の英文字
        num_parts=[1,2,3,4,5,6,7,8,9];
        new_weapon=[];
        new_num_parts=[];
        new_char_parts=[];

        var temp_weapon_parts_char = JSON.parse(JSON.stringify(weapon_parts_char[weapon_type][weapon_name]));
        var rg=document.getElementsByName("rep_gunsmith");
        //modeによって処理を変える
        if(prob_mode_gunsmith==0){
          //出現するガンスミスを設定する
          for(var i=0;i<temp_weapon_parts_char.length;i++){
            if(rg[i].checked==true){
              continue
            }else{
              temp_weapon_parts_char[i]=0
            }
          }
        }else if(prob_mode_gunsmith==1){
          for(var i=0;i<temp_weapon_parts_char.length;i++){
            if(temp_weapon_parts_char[i]==0){
              continue;
            }else{
              //出現するガンスミスを設定する
              if(rg[i].checked==true){
                temp_weapon_parts_char[i]=1;
              }else{
                //0にすることで出現させなくする.
                temp_weapon_parts_char[i]=0;
              }
            }
          }
        }
        //ランダムにガンスミスの種類をきめる
        for(var i=0;i<set_gunsmith_num;i++){
          a=choice(Math.random(),temp_weapon_parts_char);
          new_num_parts.push(num_parts[a]);
          num_parts.splice(a,1);
          temp_weapon_parts_char.splice(a,1);
        }
        //以下で数値の小さい順にソートする
        nnp=new_num_parts.sort()
        //上で決めた種類に対して詳しくどれかのパーツを決める(粒状グリップテープやOWCマークスマンなど)
        for(var i=0;i<set_gunsmith_num;i++){
          char_parts=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
          //XM4のバレルの例外処理
          if(nnp[i]==1 && weapon_type==0 && weapon_name==31){
            char_parts=["A","B","C","D","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
          }
          //Switchblade X9のperkの例外処理
          if(nnp[i]==5 && weapon_type==2 && weapon_name==19){
            char_parts=["A","B","C","D","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
          }
          //pharoのperkの例外処理
          else if(nnp[i]==5 && weapon_type==2 && weapon_name==6){
            char_parts=["A","B","C","D","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
          }
          //Striker 45のperkの例外処理
          else if(nnp[i]==8 && weapon_type==2 && weapon_name==22){
            char_parts=["A","C","D","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
          }
          //スナイパーのサイト例外処理
          else if(nnp[i]==3 && weapon_type==1){
            char_parts=["B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
          }
          //マークスマンのサイト例外処理
          else if(nnp[i]==3 && weapon_type==5){
            char_parts=["B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
            //kiloboltactionの例外処理
            if(weapon_name==0){
              char_parts=["C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
            }
            //type63の例外処理
            if(weapon_name==4){
              char_parts=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
            }
            //M1 Garandの例外処理
            if(weapon_name==5){
              char_parts=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
            }
          }
          //argus R90
          else if(nnp[i]==3 && weapon_type==4){
            if(weapon_name!=6 && weapon_name!=8){
              char_parts=["A","B","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
            }
          }
          a=Math.floor(Math.random()*weapon_parts_char[weapon_type][weapon_name][nnp[i]-1]);
          new_char_parts.push(char_parts[a]);
        }
        //以下はアタッチメントコードの文字列を取得するために配列に格納していく
        new_weapon.push(weapons[weapon_type][weapon_name]);
        new_weapon.push("-");
        for(var i=0;i<set_gunsmith_num;i++){
          new_weapon.push(new_num_parts[i]);
          new_weapon.push(new_char_parts[i]);
        }
        //配列の要素をくっつけて文字列を返す
        return new_weapon.join("");
}



function copyToClipboard() {
    const text = document.getElementById("copyTarget").textContent; // `<div>` のテキストを取得
    navigator.clipboard.writeText(text); // クリップボードにコピー
  }

//更新
function make_weapon(){
  document.querySelector('#copyTarget').textContent = make_weapon_structure();
}

addEventListener('load', function(e) {
  document.querySelector('#copyTarget').textContent = make_weapon_structure();
});

</script>
</body>
</html>